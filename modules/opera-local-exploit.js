write('opera-local-exploit', 'Creating iframe pointing to <span class="var">opera://about</span>', 1, 5);

var iframe = document.createElement('iframe');
iframe.src = 'opera://about';

write('opera-local-exploit', 'Setting <span class="var">window._isOpera = false</span>', 2, 5);
window._isOpera = false;

write('opera-local-exploit', 'Setting timeout <span class="var">isNotOpera()</span>', 3, 5);
setTimeout(isNotOpera, 100);

write('opera-local-exploit', 'Adding <span class="var">onload function</span> to injected iframe', 4, 5);
iframe.onload = isOpera;

write('opera-local-exploit', 'Injecting iframe element into body', 5, 5);
document.body.appendChild(iframe);

function isOpera() {
  window._isOpera = true;

  write('opera-local-exploit', '<span style="color: lightgreen;">Opera detected <span class="var">(loaded the URI opera://about successfully)</span>');
}

function isNotOpera() {
  if (!window._isOpera) {
    write('opera-local-exploit', '<span style="color: red;">Opera not detected <span class="var">(did not load the URI opera://about successfully)</span>');
  }
}
